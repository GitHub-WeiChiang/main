GpsDatingApp
=====
Tech Stack
-----
* ### Python
* ### Django
* ### OOP
* ### Design Patterns
* ### Multithreading
* ### MySQL (WampServer、Amazon LightSail)
* ### MySQLWorkbench
* ### ORM
* ### Redis
* ### Apache
* ### WebSocket (Django Channels)
* ### Daphne
* ### Heartbeat
* ### SSL deployments (SSL For Free)
* ### Amazon Route 53
* ### reCAPTCHA
* ### Google Analytics
* ### Google Sign-In
* ### Email sending
* ### JWT
* ### Image processing (Wand)
* ### Git
* ### GitLab
* ### SourceTree
* ### NSSM
<br />

Reference
-----
* ### test
    * ### [http://127.0.0.1:8000/test](http://127.0.0.1:8000/test)
    * ### [http://127.0.0.1:8000/close/game/flow/thread](http://127.0.0.1:8000/close/game/flow/thread)
    * ### [http://127.0.0.1:8000/delete/test/data](http://127.0.0.1:8000/delete/test/data)
    * ### [https://dev.chancedot.io/operating/status](https://dev.chancedot.io/operating/status)
    * ### [https://dev.chancedot.io/close/game/flow/thread](https://dev.chancedot.io/close/game/flow/thread)
    * ### [https://dev.chancedot.io/delete/test/data](https://dev.chancedot.io/delete/test/data)
* ### [@chance.dating | Linktree](https://linktr.ee/chance.dating)
* ### pyOnlineCompiler
    * ### [Online Python Compiler (Interpreter)](https://www.programiz.com/python-programming/online-compiler/)
    * ### [GDB online Debugger | Compiler - Code, Compile, Run, Debug online C, C++](https://www.onlinegdb.com/)
* ### aws
    * ### [Lightsail](https://lightsail.aws.amazon.com/ls/webapp/home/instances)
    * ### [Route 53 Console](https://console.aws.amazon.com/route53/v2/home#Dashboard)
    * ### [啟動 Windows 虛擬機器](https://aws.amazon.com/tw/getting-started/hands-on/launch-windows-vm/)
    * ### [如何註冊網域名稱 – Amazon Web Services](https://aws.amazon.com/tw/getting-started/hands-on/get-a-domain/)
    * ### [如何建立 MySQL 資料庫 – Amazon Web Services](https://aws.amazon.com/tw/getting-started/hands-on/create-mysql-db/)
* ### ssl
    * ### [Dashboard - ZeroSSL](https://manage.sslforfree.com/dashboard)
    * ### [nginx + SSL Certificate - 讓 http 變身成為 https » 記下來](https://noter.tw/3704/nginx-ssl-certificate-%E8%AE%93-http-%E8%AE%8A%E8%BA%AB%E6%88%90%E7%82%BA-https/)
* ### socialLogin
    * ### [Integrating Google Sign-In into your web app](https://developers.google.com/identity/sign-in/web/sign-in)
    * ### [手動建立登入流程 - Facebook 登入](https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow)
    * ### [LINE Login v2.1 API reference | LINE Developers](https://developers.line.biz/en/reference/line-login/)
* ### apache
    * ### [Deploy Django with Apache and mod_wsgi on Windows Server 2019 - YouTube](https://www.youtube.com/watch?v=frEjX1DNSpc)
    * ### [GitHub - Johnnyboycurtis/webproject: basic web project..exports data to Excel](https://github.com/Johnnyboycurtis/webproject)
    * ### [Setting up Apache HTTPS/SSL on Windows @ zer931的部落格 :: 痞客邦 ::](https://zer931.pixnet.net/blog/post/37000209-setting-up-apache-https-ssl-on-windows)
    * ### [https - Apache 2.4 configuration for ssl not working - Stack Overflow](https://stackoverflow.com/questions/20127138/apache-2-4-configuration-for-ssl-not-working)
    * ### [linux - How to automatically redirect HTTP to HTTPS on Apache servers? - Stack Overflow](https://stackoverflow.com/questions/16200501/how-to-automatically-redirect-http-to-https-on-apache-servers)
    * ### [在 windows 環境下 設定 Apache log rotate](https://icodding.blogspot.com/2015/08/windows-apache-log-rotate.html)
* ### ga
    * ### [Analytics (分析) | 首頁](https://analytics.google.com/analytics/web/?authuser=2#/p259702177/reports/defaulthome?params=_u..nav%3Ddefault)
* ### redis
    * ### [Redis 如何保持和MySQL數據一致 - 每日頭條](https://kknews.cc/zh-tw/code/vr5joya.html)
    * ### [django-redis 中文文档 — Django-Redis 4.7.0 文档](https://django-redis-chs.readthedocs.io/zh_CN/latest/)
    * ### [Redis 彻底禁用RDB持久化_xupeng1644的博客-CSDN博客_redis关闭rdb持久化](https://blog.csdn.net/xp178171640/article/details/103022501)
    * ### [Redis 關閉持久化及關閉持久化後正確刪除持久化之前的數據 - IT閱讀](https://www.itread01.com/content/1500465367.html)
    * ### [詳解Redis強制關閉Redis快照導致不能持久化錯誤的解決辦法 - 每日頭條](https://kknews.cc/zh-tw/code/naybvg5.html)
    * ### [Debugging: MISCONF Redis is configured to save RDB snapshots](https://blog.sakuragawa.moe/debugging-misconf-redis-is-configured-to-save-rdb-snapshots/)
    * ### [在windows上部署使用redis出现的问题及解决方法 - 戈博折刀 - 博客园](https://www.cnblogs.com/libin6505/p/8297499.html)
    * ### [面試官：Redis 記憶體資料滿了，會宕機嗎？_51CTO - MdEditor](https://www.gushiciku.cn/pl/pJTS/zh-tw)
* ### channels
    * ### [Django Channels — Channels 3.0.3 documentation](https://channels.readthedocs.io/en/latest/index.html)
    * ### [Channels Documentation](https://readthedocs.org/projects/channels/downloads/pdf/latest/)
    * ### [Django使用Channels實現WebSocket--上篇_開源中國 - MdEditor](https://www.mdeditor.tw/pl/21xu/zh-tw)
    * ### [onehome-server/consumers.py at master · michwh/onehome-server · GitHub](https://github.com/michwh/onehome-server/blob/master/chat/consumers.py)
    * ### [使用Django通道向單個用戶發送消息-代碼日誌](https://stackoverflow.com/questions/39322241/sending-a-message-to-a-single-user-using-django-channels)
    * ### [Deploy django-channels with Apache2 and Daphne - Stack Overflow](https://stackoverflow.com/questions/54809234/deploy-django-channels-with-apache2-and-daphne)
    * ### [(3条消息) 在windows上使用apache、uwsgi、daphne部署django、channels程序_悄悄的的博客-CSDN博客](https://blog.csdn.net/weixin_42886895/article/details/95948626)
    * ### [Deploying Django channels — The Lino framework](https://lino.readthedocs.io/en/master/admin/notify.html)
    * ### [GitHub - twtrubiks/django-channels2-tutorial: django-channels2 tutorial 💬](https://github.com/twtrubiks/django-channels2-tutorial)
    * ### [django-channels2-tutorial (PART 2) - 說明 - YouTube](https://www.youtube.com/watch?v=_4Q801WL8sA)
    * ### [javascript - Django channels using secured WebSocket connection - WSS:// - Stack Overflow](https://stackoverflow.com/questions/58761399/django-channels-using-secured-websocket-connection-wss)
    * ### [GitHub - django/daphne: Django Channels HTTP/WebSocket server](https://github.com/django/daphne)
    * ### [EasySwoole-WebSocket在线测试工具](http://www.easyswoole.com/wstool.html)
    * ### [websocket在线测试](http://www.websocket-test.com/)
* ### daphne
    * ### [Deploying — Channels 3.0.3 documentation](https://channels.readthedocs.io/en/latest/deploying.html?highlight=daphne)
    * ### [Issues · django/daphne · GitHub](https://github.com/django/daphne/issues/)
    * ### [如何使用Apache和Daphne部署Django頻道？ - 堆棧溢出](https://stackoverflow.com/questions/63320463/how-to-deploy-django-channels-with-apache-and-daphne/63332646#63332646)
    * ### [How to deploy django channels with Apache + Daphne? : django](https://www.reddit.com/r/django/comments/i62q0a/how_to_deploy_django_channels_with_apache_daphne/)
    * ### [daphne · PyPI](https://pypi.org/project/daphne/)
    * ### [Apache Reverse Proxy 實作 @ ERIC's Blog :: 痞客邦 ::](https://lovejulie.pixnet.net/blog/post/23963253)
    * ### [daphne(1) — daphne — Debian testing — Debian Manpages](https://manpages.debian.org/testing/daphne/daphne.1.en.html)
    * ### [NSSM - 安裝 windows 服務以運行 django 頻道的 daphne 服務器 - DevDreamz](https://devdreamz.com/question/785533-nssm-install-windows-service-to-run-daphne-server-for-django-channels)
* ### .crt.key convert .pem
    * ### [ssl - How to get .pem file from .key and .crt files? - Stack Overflow](https://stackoverflow.com/questions/991758/how-to-get-pem-file-from-key-and-crt-files)
    * ### [x509 - How to convert .crt to .pem - Stack Overflow](https://stackoverflow.com/questions/4691699/how-to-convert-crt-to-pem)
* ### image
    * ### [django 使用 PIL 壓縮圖片 - IT閱讀](https://www.itread01.com/content/1547568917.html)
    * ### [How to work with HEIC image file types in Python - Stack Overflow](https://stackoverflow.com/questions/54395735/how-to-work-with-heic-image-file-types-in-python)
    * ### [Wand — Wand 0.6.8](https://docs.wand-py.org/en/latest/index.html)
* ### other
    * ### [DevOps - 維基百科，自由的百科全書](https://zh.wikipedia.org/wiki/DevOps)
    * ### [SQL語法教學 - 1Keydata](https://www.1keydata.com/tw/sql/sql.html)
    * ### [Django Request对象详解及用它显示真实IP地址 - 知乎](https://zhuanlan.zhihu.com/p/41730514)
    * ### [fcm-django — fcm-django latest documentation](https://fcm-django.readthedocs.io/en/latest/)
    * ### [django 自定义404页面_两鬓已不能斑白的专栏-CSDN博客](https://blog.csdn.net/u010429424/article/details/77363531)
    * ### [智慧財產局](https://tiponet.tipo.gov.tw/030_OUT_V1/home.do)
    * ### [Datta Able - Premium Django Dashboard | AppSeed](https://appseed.us/admin-dashboards/django-dashboard-dattaable-pro)
<br />

後端
-----
* ### 2020/11/15
    - [x] 資料表新增與修正
* ### 2020/11/29
    - [x] 自動寄信功能撰寫與測試
* ### 2020/12/06
    - [x] HTML Email 導入
    - [x] 資料庫升級
    - [x] 事前預約 api
    - [x] 後端存活 api
    - [x] recaptcha 導入
* ### 2020/12/13
    - [x] redis 導入 & 資料庫修正
    - [x] 狀態碼修正
    - [x] 事前預約 api 加入驗證
    - [x] 修正 事前預約驗證錯誤次數
    - [x] 增加 X-Requested-With 判斷
    - [x] logger 導入
    - [x] 帳號創建信箱驗證
    - [x] 登入信箱驗證
    - [x] jwt 導入
* ### 2020/12/20
    - [x] 修正驗證碼驗證錯誤導致倒數重置問題
    - [x] 修正 職稱 為 學校
    - [x] 驗證失敗回傳剩餘次數
    - [x] 整理代碼、資料庫修正
* ### 2020/12/27
    - [x] 新增使用者暱稱欄位
    - [x] 資料庫優化與 API 名稱修正
    - [x] policy api
    - [x] lastRefresh 欄位值更新
    - [x] 資料庫群集建立與 default 設定
    - [x] 基本設定 API
    - [x] 圖片管理
    - [x] 大頭貼 API
    - [x] 配對資訊 API
    - [x] 移除 app 端 recaptcha 檢查
    - [x] Google Sign-In 導入
* ### 2021/01/03
    - [x] 資料庫修正
    - [x] 修正 json.load 錯誤
* ### 2021/01/10
    - [x] logo url api
    - [x] status code 整理
    - [x] 資料庫名詞定義
    - [x] status code 類別修正
    - [x] 資料庫組態修正
    - [x] 圖檔大小限制
    - [x] 配對檢查
    - [x] API 文檔優化
* ### 2021/01/17
    - [x] 行銷問題 yt、ig、dcard、tinder
    - [x] AWS 虛擬主家架設
    - [x] apache 部屬
    - [x] SSL
    - [x] 第三方相關網域新增
    - [x] AWS MySQL 架設
* ### 2021/01/24
    - [x] 資料表增加使用者身分
    - [x] Google Sign-In 獨立
    - [x] isRegister 更新
    - [x] 登入碼改為八碼
    - [x] GA 設定
    - [x] 調整 dns
    - [x] 測試
* ### 2021/01/31
    - [x] 修正 registerInfo 資料表經緯度欄位
    - [x] 修正 pairingRecord 資料表經緯度欄位
    - [x] 修正無事前預約之帳號註冊
    - [x] 增加 區 欄位於 registerInfo 資料表
    - [x] 增加 區 欄位於 pairingRecord 資料表
    - [x] 增加欄位 是否完成快速設定 於 accountStatus 資料表
    - [x] 確認 models 的 list & date 如何加入
    - [x] 修正 allow host
    - [x] 生活分享 api
    - [x] 快速設定 API & db 欄位 (是否完成快速設定) 更新
    - [x] 登入相關 api 回傳 是否完成快速設定
* ### 2021/02/07
    - [x] 執行緒
* ### 2021/02/14
    - [x] 自動運行
* ### 2021/02/21
    - [x] 增加陣列檢查
    - [x] 修正 quickSsetting 名稱
* ### 2021/02/28
    - [x] 新增清空資料庫 url (便於測試)
    - [x] 刪除性向
    - [x] api 分離 圖片變數(userId、access、image) 與 常態變數
    - [x] 檢查年齡
    - [x] 將 advancedInfo 中的 place 替換為 country 和 city
    - [x] 完善 Avatar delete func (刪圖片)
    - [x] 完善 LifeSharing delete func (刪圖片)
* ### 2021/03/07
    - [x] 修正清空資料庫 bug
    - [x] 遊戲狀態機架構設計
    - [x] 新增 redis access class
    - [x] 配對邏輯開發
    - [x] 遊戲狀態機功能開發 (不包含 socket 相關功能)
    - [x] 遊戲流程設計與開發
* ### 2021/03/14
    - [x] 處理合約問題
* ### 2021/03/21
    - [x] 配對成功更新 socialInfo db
    - [x] 算資金 (半年)
    - [x] 推播通知與socket
* ### 2021/03/28
    - [x] socket 架構撰寫
    - [x] 配對成功更新 pairingRecord db
    - [x] 修正 pairingRecord 缺少 locate、district 問題
    - [x] 移除 socket http 檢查
    - [x] 測試 ws with runserver
* ### 2021/04/04
    - [x] 統一改 locate 為 city
    - [x] socket 連線身分認證
    - [x] GameConsumer GameRoom Group
    - [x] GameConsumer Independent Group
    - [x] 遊戲狀態機 broadcastPairingsResult
    - [x] 遊戲狀態機 joinStateNotify
    - [x] update server db、redis、pip
    - [x] WS 規格書
    - [x] 測試 wss with runserver_plus + daphne
    - [x] 測試 wss with apache + mod_wsgi + daphne
* ### 2021/04/11
    - [x] 心跳包 閱讀
* ### 2021/04/18
    - [x] 商標 申請
    - [x] 配對機制加入簡單心跳包判斷
    - [x] 測試 socket 收發封包
* ### 2021/04/25
    - [x] redis 優化
    - [x] 聊天室
* ### 2021/05/02
    - [x] SocialInfoRedis 完善與優化 (blockadeList)
    - [x] UserInfoRedis 完善與優化 (照片、分享)
    - [x] 新增 userInfoAcquisition API
* ### 2021/05/09
    - [x] 事前預約資訊 api
    - [x] 事前預約地區檢查
    - [x] nickname 長度限制檢查
    - [x] api 文檔更新
    - [x] ws 文檔更新
    - [x] Status code 文檔更新
    - [x] Game State Code 文檔更新
    - [x] lock import
* ### 2021/05/11
    - [x] 好友封鎖優化
    - [x] 聊天優化
* ### 上線前工作 5/12
    - [x] 其餘查詢寫入 api 建置 (配合前端)
    - [x] 網頁文宣檢查與補充
    - [x] prd server 相關架設事宜
    - [x] 專利申請
* ### 剩餘工作
    - [x] 優化 redis 到 windows server
    - [x] 防止重複傳送配對位置
    - [x] 聊天不能傳訊息給被封鎖的人
    - [x] Ddos 防禦
* ### 2021/09/04
    - [x] 學校清單整理
    - [x] 修正非格式化日期報錯
    - [x] 增加生活分享輔助陣列
* ### 2021/09/11
    - [x] convert heic to jpg
    - [x] compression image
* ### 2021/09/18
    - [x] 拔除生活分享輔助陣列
    - [x] 增加 院校 判斷
    - [x] 增加 類組 判斷
    - [x] 增加 國家 判斷
    - [x] 增加 縣市 判斷
* ### 2021/09/25
    - [x] 優化結束配對執行緒判斷 while(True replace isClose)
    - [x] 加上生活分享預設圖
    - [x] 回傳生活分享預設 url
* ### 2021/10/09
    - [x] GameConsumer self.scope['userId'] 除錯
    - [x] 解決機制誤差問題 -> --noreload
    - [x] 解決 ws 突斷問題 -> 注意 key 底線拆解
* ### 2021/10/17
    - [x] 解決 daphne 問題
* ### 2021/10/24
    - [x] 優化 chat ws api friendListApply 增加姓名與頭貼
    - [x] 新增 ws 好友管理 facade 類別
    - [x] 將 ws 相關好友管理權限交由 ws 好友管理 facade 處理
    - [x] 將封鎖 api 從 http 移至 ws
* ### App 上線前工作
    - [ ] 買禮物
    - [ ] 管理員 api: 遊戲機制開啟與關閉
    - [ ] 管理員 api: email 發送
    - [ ] app 登入驗證 html email template 導入
    - [ ] app 註冊驗證 html email template 導入
* ### 優化工作
    - [x] 代碼整理
    - [x] 代碼優化
    - [x] null object import
* ### next deploy prd 注意事項
    * pip install Wand
    * download ImageMagick
    * create default folder in media folder
    * upload lifeSharing.png in default folder
* ### 特殊紀錄
    * delete mysqlclient in requirements.txt
    * pip uninstall mysqlclient
    * pip install mysqlclient
    * add mysqlclient in requirements.txt
    * openssl rsa -in server.key -text > private.pem
    * openssl x509 -inform PEM -in server.crt > public.pem
* ### 工作箱
    - [x] domain 分類
        * production
            - [x] web
                * chance.chanctdot.io ↓
                * Windows_Server_2019-2 ip
            - [x] api
                * api.chanctdot.io ↓
                * chance.chanctdot.io
        * development
            - [x] web
                * dev.chancedot.io ↓
                * Windows_Server_2019-1 ip
            - [x] api
                * dev.chancedot.io ↓
                * Windows_Server_2019-1 ip
